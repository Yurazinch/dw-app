# План к дипломному проекту #

*Среда разработки:*

1. Сервер: Apache/2.4.64 (Win64)
Apache Lounge VS17 Server built:   Jul  9 2025.

2. PHP 8.4.10 (cli) (built: Jul  2 2025 11:04:43) (ZTS Visual C++ 2022 x64)
Copyright (c) The PHP Group
Zend Engine v4.4.10, Copyright (c) Zend Technologies.

3. База данных SQLite.

*Развертывание проекта:*

1. Перед началом убедитесь, что на вашем локальном компьютере установлены следующие программы:
    - Git: Для клонирования репозитория.
    - PHP: Необходимая версия для проекта (подробности см. выше).
    - Composer: Для управления зависимостями PHP.
    - Node.js и npm (управление зависимостями интерфейса).
    - Сервер базы данных SQLite.

2. Клонируйте проект
    - Откройте терминал или командную строку, перейдите в нужную директорию и клонируйте репозиторий, используя URL-адрес GitHub: git clone [repository_url];
    Замените [repository_url] на фактическую HTTPS или SSH ссылку со страницы проекта GitHub. 

3. Перейдите в каталог проектов.
    - Перейдите в текущий каталог, который вы нашли в только что клонированной папке проекта:
    cd [project_folder_name];
    
4. Установите зависимости PHP.
    - В проектах Laravel зависимости не включаются в Git. Используйте Composer для их установки:  composer install
    - Если в проекте используется Docker/Laravel Sail, вы можете использовать команду ./vendor/bin/sail composer install или специальную команду Docker, если Sail еще не установлен.

5. Настройте файл среды.
    - Скопируйте пример файла среды, чтобы создать локальный файл .env. В этом файле хранятся важные настройки приложения, и он не добавляется в Git:
    в macOS/Linux: cp .env.example .env
    в Windows: copy .env.example .env

6. Сгенерируйте ключ приложения
    - Laravel требует наличия ключа приложения в целях безопасности. 
    Выполните эту команду Artisan, чтобы сгенерировать и установить его в вашем новом файле 
    .env: php artisan key:generate .

7. Настройте базы данных
    - Обновите параметры подключения к базе данных в файле .env (например, DB_DATABASE, DB_USERNAME, DB_PASSWORD) в соответствии с локальной конфигурацией вашей базы данных.
    -   Убедитесь, что вы создали указанную базу данных на своем локальном сервере (для SQLite команда touch database/database.sqlite).

8. Выполните миграции и заполнения базовых файлов (seeding).
    - Примените структуру базы данных, определенную в миграциях проекта, и зарегистрируйте администратора: 
    php artisan migrate
    php artisan db:seed (добавит администратора ['name' => 'Adm', 'email' => 'adm@demo.dw', 'password' => 'demodemo']).
 
9. Установите и скомпилируйте ресурсы интерфейса.
    - Выполните команды:
    npm install
    npm run dev

10. Активируйте символические ссылки.
    php artisan storage:link

11. Пакет для генерации QR-кода использует библиотеку PHP GD (или Imagick) для обработки         изображений. Убедитесь, что расширение gd включено в вашем файле php.ini:
    - Найдите файл php.ini для вашей среды (файлы для CLI и веб-сервера могут быть отдельными).
    - Найдите строку extension=gd (или extension=php_gd.dll в Windows) и удалите точку с запятой (;) в начале строки, если она закомментирована.
    - Перезапустите веб-сервер (Apache, Nginx и т. д.), чтобы изменения вступили в силу.
Или подключите библиотеку Imagick: (https://pecl.php.net/package/imagick; https://www.php.net/manual/ru/imagick.setup.php).

12. Запустите локальный сервер разработки:
    - Выполните команду:
    composer run dev (в браузере откроется адрес http://localhost:8000/).
    Для перехода на страницу администратора нужно ввести адрес http://localhost:8000/admin . Логин и пароль администратора см. п.8.

-------------------


*Анализ проекта*

<u>Кинозал</u> - связан один со многими местами, сеансами, фильмами. 
@param $hallId, [$row => [$place => 'standart' || 'vip' || 'disabled']]

<u>Место</u> - связано с билетом на время его действия.
@param $ticketId, $sessionId, $busy (false || true).

<u>Фильм</u> - связан со многими сеансами, зрительным залом.
@param $filmId, $name, $description, $time, $country

<u>Сеанс</u> - связан с залом и фильмом, ценой. Ограничен временным отрезком. По завершению деактивируется.
@param $sessionId, $hallId, $filmId, $date, $prise, $priseVip, $startTime, $stopTime

<u>Билет</u> - связан с сеансом, местом.
@param $ticketId, $sessionId, $hall[$row][$place]

Для зрителя возможен выбор билета, остальные маршруты закрыты идентификацией.

Для админиcтратора доступны все маршруты после авторизации.

Вход на сайт - гостевой ./index.html : view (/).

Вход для администратора - ./admin/index.html : view (/admin) -> auth.

Формировать модель + контроллер + миграция Hall, Place, Film, Session, Ticket, User(Администратор).

Создание зрительского зала (auth) = созданию шаблона мест для сеансов. Заполняется в разметке (представлении), затем через $request передается и обрабатывается в таблицу в контроллере: колонки - ряды, значения в колонках - массив: № места => статус.
Конфигурация зала задается из административной паннели.

Создание фильма (auth) = статическая запись в базе данных, которая связана с сеансами.

При создании сеанса (auth) создается экземпляр зала, ссылка на фильм, дата, временной интервал, цены (обычная и vip).

При создании билета создается экземпляр сеанса, места и цена (в зависимости от статуса места).

## Создание зрительного зала // сделано

1. Заданные параметры ($rows => $places) отправляются (post) в контроллер Hall метод create. 
2. В методе формируются ячейки (/row/{row}/num/{num}), заполняются значением $status => 'buying-scheme__chair_disabled' и сохраняются в database.

## Редактирование зрительного зала // сделано

1. Через $hallId контроллер Hall отправляет (get) матрицу зала (/row/{row}/num/{num}), в представлении формируется план зала, ячейкам присваивается class='buying-scheme__chair {{$status}}'.
2. Admin устанавливает статус мест ('standart', 'vip'). Статус мест устанавливается в клиенте посредством js: функцией forEach обработчик события 'click' с проверкой статуса.
3. При сохранении обновленная информация по $hallId контроллером Hall обновляется (метод update) новыми значениями $status ('buying-scheme__chair_enabled' или 'buying-scheme__chair_vip').

## Добавление фильма // сделано

1. Данные из формы методом post отправляются в контроллер Film метод create.
2. Переменные $name, $description, $time, $country сохраняются в таблице films с уникальным $filmID.
3. Постер через фасад Storage помещается в папку storage/app/public.
4. Ссылка на файл постера $poster хранится в таблице $filmId.

## Цены // сделано !добавить предупреждение при отсутствии плана зала!
1. Данные из формы методом post отправляются в контроллер Price метод create.
2. $priceId связывается с $hallId.

## Сетка сеансов // сделано
1. Фильмы методом get из таблицы films контроллером Film добавляются в поле фильмов.
2. *Реализацию добавления в сетку нужно продумать, пока не понятно*.

## Открыть продажи

1. Активация клиентской части сайта. 
2. При запрете продаж блокируется страница заказа.

## Клиентская часть // в разработке

1. Отображение фильмов с сеансами по залам - главная страница. // сделано
2. Переход на страницу заказа (данные: дата (date), сеанс (id)).
    - отрисовка зала;
    - выбор мест (статус 'select' - предусмотреть возврат статуса места при отмене выбора);
    - бронировние выбранных мест при заказе (статус 'booked').
3. Переход на страницу подтверждения заказа (данные: дата (date), фильм (name), места (numbers), зал (name), цена (summ)).
4. Переход на страницу билета (запрос стороннего приложения).




